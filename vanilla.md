# Конфигурация под битрикс

nginx + php (8.2, 8.3, 8.4) + mysql|postgres|sqlite + node 23 версии
а так же redis|memcached

## Шаги публикации docker-compose.yml

Шаги:

0. Выбор фреймворка - vanilla
1. Выбрать версию php
2. Выберите базу данных - mysql|postgres|sqlite
3. Выбрать версию базы данных
4. Выберите сервер для кеширования - redis|memcached|Пропуск
5. Устанавливать ли node.js - Y или N, если установите Y, то будет создан сервис с node js 23 версии
    1. Если будет устанавливаться node.js, то нужно указать корневую директорию для него, то есть директория содержащая файл package.json. Путь указывается относительно корня сайта - local/js/vite или пустое поле если package.json в корне сайта.

После этого в директории где выполнялась команда появиться docker-compose.yml файл с настроенными сервисами.

В директории site можете создавать php проект

## Сервер

точка входа в приложение - site/index.php

изменить настройки сервера/конфигураци php можно с помощью комнады 

```bash
docky publish
```

подробнее в [README.md#Публикация докерфайлов и файлов конфигурации](README.md)

## Cron

По умолчанию cron включен

Если необходимо добавить задания, то сделайте публикацию файлов с заданиями

```bash
docky publish --file cron_tasks
```

Запись заданий осуществляйте в:
- `${CONF_PATH}/app/cron/docky` - для пользователя сайта
- `${CONF_PATH}/app/cron/root` - для root пользователя

## Почта

msmtp клиент не устанавливается.
Используйте сервис mailhog для тестирования отправки почты.

- host=mailhog
- port=1025

панель доступна на - localhost:8025

## Vite config 

используйте команды ```docky npm``` чтобы запускать npm команды в контейнере

и добавьте настройки сервера в vite.config.js 

```
    server: {
        host: '0.0.0.0',
        port: 5173,
        open: false,
        cors: {
            origin: '*'
        },
        hmr: {
            host: 'localhost',
        },
    }
```

